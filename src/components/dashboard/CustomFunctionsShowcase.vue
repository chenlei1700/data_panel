<template>
  <div class="custom-functions-showcase">
    <h2>ğŸ“Š æ–°å¢è‡ªå®šä¹‰èƒŒæ™¯è‰²å‡½æ•°å±•ç¤º</h2>
    
    <!-- è‚¡ç¥¨å¼ºåŠ¿åº¦è¯„åˆ†ç¤ºä¾‹ -->
    <div class="demo-section">
      <h3>ğŸ”¥ è‚¡ç¥¨å¼ºåŠ¿åº¦ç»¼åˆè¯„åˆ†ç€è‰²</h3>
      <p class="description">åŸºäºæ¶¨å¹…ã€æˆäº¤é‡ã€æ¢æ‰‹ç‡ã€è¿æ¿æ•°ã€PEç­‰å¤šä¸ªæŒ‡æ ‡ç»¼åˆè¯„åˆ†</p>
      <TableComponent :componentConfig="strengthTableConfig" />
      <div class="color-legend">
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 0, 0, 0.8);"></span>è¶…å¼ºåŠ¿ (â‰¥7åˆ†)</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 69, 0, 0.7);"></span>å¼ºåŠ¿ (5-6åˆ†)</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 140, 0, 0.6);"></span>è¾ƒå¼ºåŠ¿ (3-4åˆ†)</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 215, 0, 0.5);"></span>åå¼ºåŠ¿ (1-2åˆ†)</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(144, 238, 144, 0.4);"></span>ä¸­æ€§ (0åˆ†)</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 182, 193, 0.5);"></span>åå¼±åŠ¿ (-1è‡³-2åˆ†)</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(220, 20, 60, 0.6);"></span>å¼±åŠ¿ (<-2åˆ†)</span>
      </div>
    </div>

    <!-- ä»·æ ¼åŒºé—´ç€è‰²ç¤ºä¾‹ -->
    <div class="demo-section">
      <h3>ğŸ’° ä»·æ ¼åŒºé—´ç€è‰²</h3>
      <p class="description">æ ¹æ®è‚¡ä»·åŒºé—´æ˜¾ç¤ºä¸åŒé¢œè‰²ï¼Œä¾¿äºè¯†åˆ«é«˜ä»·è‚¡å’Œä½ä»·è‚¡</p>
      <TableComponent :componentConfig="priceRangeTableConfig" />
      <div class="color-legend">
        <span class="legend-item"><span class="color-box" style="background: rgba(138, 43, 226, 0.4);"></span>>1000å…ƒ (è¶…é«˜ä»·è‚¡)</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 215, 0, 0.4);"></span>100-1000å…ƒ (é«˜ä»·è‚¡)</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(0, 191, 255, 0.4);"></span>50-100å…ƒ (ä¸­é«˜ä»·è‚¡)</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(0, 255, 0, 0.4);"></span>20-50å…ƒ (ä¸­ä»·è‚¡)</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 255, 0, 0.4);"></span>10-20å…ƒ (ä¸­ä½ä»·è‚¡)</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 165, 0, 0.4);"></span>5-10å…ƒ (ä½ä»·è‚¡)</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 99, 71, 0.4);"></span><5å…ƒ (è¶…ä½ä»·è‚¡)</span>
      </div>
    </div>

    <!-- æ¶¨åœæ¿æ¢¯åº¦ç€è‰²ç¤ºä¾‹ -->
    <div class="demo-section">
      <h3>ğŸ“ˆ æ¶¨åœæ¿æ¢¯åº¦ç€è‰²</h3>
      <p class="description">æ ¹æ®è¿æ¿æ•°æ˜¾ç¤ºä¸åŒå¼ºåº¦çš„é¢œè‰²ï¼Œçªå‡ºæ˜¾ç¤ºé«˜è¿æ¿è‚¡ç¥¨</p>
      <TableComponent :componentConfig="limitUpTableConfig" />
      <div class="color-legend">
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 192, 203, 0.5);"></span>é¦–æ¿</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 255, 0, 0.6);"></span>äºŒæ¿</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 165, 0, 0.7);"></span>ä¸‰æ¿</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 69, 0, 0.8);"></span>å››æ¿</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 0, 0, 0.9);"></span>äº”æ¿ä»¥ä¸Š</span>
      </div>
    </div>

    <!-- ç›¸å¯¹è¡¨ç°ç€è‰²ç¤ºä¾‹ -->
    <div class="demo-section">
      <h3>ğŸ“Š ç›¸å¯¹è¡¨ç°ç€è‰²</h3>
      <p class="description">åŸºäºç»Ÿè®¡å­¦Z-scoreï¼Œæ˜¾ç¤ºç›¸å¯¹äºåŒç»„å¹³å‡å€¼çš„è¡¨ç°</p>
      <TableComponent :componentConfig="relativeTableConfig" />
      <div class="color-legend">
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 0, 0, 0.8);"></span>æ˜¾è‘—é«˜äºå¹³å‡ (Z>2)</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 69, 0, 0.6);"></span>é«˜äºå¹³å‡ (Z>1)</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 140, 0, 0.4);"></span>ç•¥é«˜äºå¹³å‡ (Z>0.5)</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(144, 238, 144, 0.3);"></span>æ¥è¿‘å¹³å‡ (-0.5<Z<0.5)</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(255, 182, 193, 0.4);"></span>ç•¥ä½äºå¹³å‡ (Z<-0.5)</span>
        <span class="legend-item"><span class="color-box" style="background: rgba(105, 105, 105, 0.8);"></span>æ˜¾è‘—ä½äºå¹³å‡ (Z<-2)</span>
      </div>
    </div>

    <div class="usage-tips">
      <h3>ğŸ’¡ ä½¿ç”¨æ–¹æ³•</h3>
      <div class="code-example">
        <h4>åœ¨æœåŠ¡å™¨ç«¯é…ç½®ï¼š</h4>
        <pre><code># åœ¨ show_plate_server.py ä¸­
columns = [
  {"field": "ç»¼åˆè¯„åˆ†", "header": "ç»¼åˆè¯„åˆ†", "backgroundColor": "stockStrength"},
  {"field": "price", "header": "è‚¡ä»·", "backgroundColor": "priceRange"},
  {"field": "è¿æ¿æ•°", "header": "è¿æ¿æ•°", "backgroundColor": "limitUpGradient"},
  {"field": "change", "header": "æ¶¨è·Œå¹…", "backgroundColor": "relativePerformance"}
]</code></pre>
        
        <h4>åœ¨å‰ç«¯ç»„ä»¶ä¸­ä½¿ç”¨ï¼š</h4>
        <pre><code>// åœ¨ Vue ç»„ä»¶ä¸­
{
  field: 'price',
  header: 'è‚¡ä»·',
  backgroundColor: 'priceRange'  // ä½¿ç”¨è‡ªå®šä¹‰å‡½æ•°å
}</code></pre>
      </div>
    </div>
  </div>
</template>

<script>
import { defineComponent, ref } from 'vue';
import TableComponent from './TableComponent.vue';

export default defineComponent({
  name: 'CustomFunctionsShowcase',
  components: {
    TableComponent
  },
  setup() {
    // è‚¡ç¥¨å¼ºåŠ¿åº¦è¯„åˆ†æ•°æ®
    const strengthData = {
      columns: [
        { field: 'name', header: 'è‚¡ç¥¨åç§°' },
        { field: 'price', header: 'è‚¡ä»·' },
        { field: 'change', header: 'æ¶¨è·Œå¹…' },
        { field: 'volume_ratio', header: 'é‡æ¯”' },
        { field: 'å¼€ç›˜æ¢æ‰‹ç‡', header: 'å¼€ç›˜æ¢æ‰‹ç‡' },
        { field: 'è¿æ¿æ•°', header: 'è¿æ¿æ•°' },
        { field: 'pe_ratio', header: 'PE' },
        { field: 'strength', header: 'ç»¼åˆè¯„åˆ†', backgroundColor: 'stockStrength' }
      ],
      rows: [
        { name: 'ä¸œæ–¹è´¢å¯Œ', price: 18.5, change: 9.8, volume_ratio: 4.2, 'å¼€ç›˜æ¢æ‰‹ç‡': 12.5, 'è¿æ¿æ•°': 2, pe_ratio: 18.5, strength: 'å¼ºåŠ¿' },
        { name: 'æ¯”äºšè¿ª', price: 185.3, change: 6.2, volume_ratio: 2.8, 'å¼€ç›˜æ¢æ‰‹ç‡': 8.3, 'è¿æ¿æ•°': 1, pe_ratio: 25.6, strength: 'è¾ƒå¼ºåŠ¿' },
        { name: 'å®å¾·æ—¶ä»£', price: 320.5, change: 4.1, volume_ratio: 1.9, 'å¼€ç›˜æ¢æ‰‹ç‡': 5.2, 'è¿æ¿æ•°': 0, pe_ratio: 45.2, strength: 'åå¼ºåŠ¿' },
        { name: 'å¹³å®‰é“¶è¡Œ', price: 12.5, change: 2.3, volume_ratio: 1.2, 'å¼€ç›˜æ¢æ‰‹ç‡': 3.1, 'è¿æ¿æ•°': 0, pe_ratio: 8.5, strength: 'ä¸­æ€§' },
        { name: 'æ‹›å•†é“¶è¡Œ', price: 45.2, change: -1.8, volume_ratio: 0.8, 'å¼€ç›˜æ¢æ‰‹ç‡': 2.1, 'è¿æ¿æ•°': 0, pe_ratio: 12.3, strength: 'åå¼±åŠ¿' },
        { name: 'ä¸­å›½çŸ³æ²¹', price: 8.2, change: -3.5, volume_ratio: 0.6, 'å¼€ç›˜æ¢æ‰‹ç‡': 1.5, 'è¿æ¿æ•°': 0, pe_ratio: 55.8, strength: 'å¼±åŠ¿' }
      ]
    };

    // ä»·æ ¼åŒºé—´æ•°æ®
    const priceRangeData = {
      columns: [
        { field: 'name', header: 'è‚¡ç¥¨åç§°' },
        { field: 'price', header: 'è‚¡ä»·', backgroundColor: 'priceRange' },
        { field: 'market_cap', header: 'å¸‚å€¼(äº¿)' },
        { field: 'category', header: 'ä»·æ ¼åˆ†ç±»' }
      ],
      rows: [
        { name: 'è´µå·èŒ…å°', price: 1680.5, market_cap: 21000, category: 'è¶…é«˜ä»·è‚¡' },
        { name: 'é•¿æ˜¥é«˜æ–°', price: 185.3, market_cap: 580, category: 'é«˜ä»·è‚¡' },
        { name: 'éš†åŸºç»¿èƒ½', price: 28.9, market_cap: 1850, category: 'ä¸­ä»·è‚¡' },
        { name: 'æ ¼åŠ›ç”µå™¨', price: 38.9, market_cap: 2200, category: 'ä¸­ä»·è‚¡' },
        { name: 'ä¸‡ç§‘A', price: 23.1, market_cap: 2600, category: 'ä¸­ä»·è‚¡' },
        { name: 'å¹³å®‰é“¶è¡Œ', price: 12.5, market_cap: 2400, category: 'ä¸­ä½ä»·è‚¡' },
        { name: 'ä¸­å›½çŸ³æ²¹', price: 8.2, market_cap: 7500, category: 'ä½ä»·è‚¡' },
        { name: 'STæµ·åŒ»', price: 3.8, market_cap: 35, category: 'è¶…ä½ä»·è‚¡' }
      ]
    };

    // æ¶¨åœæ¿æ¢¯åº¦æ•°æ®
    const limitUpData = {
      columns: [
        { field: 'name', header: 'è‚¡ç¥¨åç§°' },
        { field: 'price', header: 'è‚¡ä»·' },
        { field: 'change', header: 'æ¶¨è·Œå¹…' },
        { field: 'è¿æ¿æ•°', header: 'è¿æ¿æ•°', backgroundColor: 'limitUpGradient' },
        { field: 'reason', header: 'æ¶¨åœåŸå› ' }
      ],
      rows: [
        { name: 'å¦–è‚¡ç‹', price: 25.8, change: 10.0, 'è¿æ¿æ•°': 6, reason: 'AIæ¦‚å¿µ+ä¸šç»©æš´å¢' },
        { name: 'å››æ¿é¾™å¤´', price: 18.2, change: 10.0, 'è¿æ¿æ•°': 4, reason: 'æ–°èƒ½æºæ±½è½¦' },
        { name: 'ä¸‰æ¿è·Ÿé£', price: 12.5, change: 10.0, 'è¿æ¿æ•°': 3, reason: 'è·Ÿé£ç‚’ä½œ' },
        { name: 'äºŒæ¿åŠ é€Ÿ', price: 15.8, change: 10.0, 'è¿æ¿æ•°': 2, reason: 'æ”¿ç­–åˆ©å¥½' },
        { name: 'é¦–æ¿å¯åŠ¨', price: 22.3, change: 10.0, 'è¿æ¿æ•°': 1, reason: 'é‡ç»„é¢„æœŸ' },
        { name: 'æ™®é€šè‚¡ç¥¨', price: 28.9, change: 3.2, 'è¿æ¿æ•°': 0, reason: 'æ­£å¸¸æ³¢åŠ¨' }
      ]
    };

    // ç›¸å¯¹è¡¨ç°æ•°æ®
    const relativeData = {
      columns: [
        { field: 'name', header: 'æ¿å—åç§°' },
        { field: 'change', header: 'æ¿å—æ¶¨å¹…', backgroundColor: 'relativePerformance' },
        { field: 'volume_ratio', header: 'é‡æ¯”', backgroundColor: 'relativePerformance' },
        { field: 'up_stocks', header: 'ä¸Šæ¶¨è‚¡ç¥¨æ•°' }
      ],
      rows: [
        { name: 'äººå·¥æ™ºèƒ½', change: 8.5, volume_ratio: 3.2, up_stocks: 45 },
        { name: 'æ–°èƒ½æºæ±½è½¦', change: 6.8, volume_ratio: 2.8, up_stocks: 38 },
        { name: 'å…‰ä¼æ¦‚å¿µ', change: 4.2, volume_ratio: 1.9, up_stocks: 32 },
        { name: 'åŠå¯¼ä½“', change: 2.1, volume_ratio: 1.5, up_stocks: 25 },
        { name: 'æ¶ˆè´¹ç”µå­', change: 0.8, volume_ratio: 1.1, up_stocks: 18 },
        { name: 'æˆ¿åœ°äº§', change: -1.2, volume_ratio: 0.8, up_stocks: 8 },
        { name: 'é“¶è¡Œæ¿å—', change: -2.1, volume_ratio: 0.6, up_stocks: 5 },
        { name: 'ç…¤ç‚­é’¢é“', change: -4.5, volume_ratio: 0.4, up_stocks: 2 }
      ]
    };

    const strengthTableConfig = ref({
      id: 'strength-table',
      apiData: strengthData
    });

    const priceRangeTableConfig = ref({
      id: 'price-range-table',
      apiData: priceRangeData
    });

    const limitUpTableConfig = ref({
      id: 'limit-up-table',
      apiData: limitUpData
    });

    const relativeTableConfig = ref({
      id: 'relative-table',
      apiData: relativeData
    });

    return {
      strengthTableConfig,
      priceRangeTableConfig,
      limitUpTableConfig,
      relativeTableConfig
    };
  }
});
</script>

<style scoped>
.custom-functions-showcase {
  padding: 20px;
  max-width: 1600px;
  margin: 0 auto;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

.demo-section {
  margin-bottom: 50px;
  padding: 25px;
  border: 2px solid #e1e8ed;
  border-radius: 12px;
  background: linear-gradient(145deg, #fafbfc, #f5f7fa);
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.demo-section h3 {
  margin-top: 0;
  color: #2c3e50;
  border-bottom: 3px solid #3498db;
  padding-bottom: 12px;
  font-size: 1.4em;
}

.description {
  color: #7f8c8d;
  font-style: italic;
  margin-bottom: 20px;
  font-size: 1.1em;
}

.color-legend {
  margin-top: 15px;
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  padding: 15px;
  background: rgba(255,255,255,0.8);
  border-radius: 8px;
  border: 1px solid #ddd;
}

.legend-item {
  display: flex;
  align-items: center;
  font-size: 0.9em;
  color: #555;
}

.color-box {
  width: 20px;
  height: 16px;
  border-radius: 4px;
  margin-right: 8px;
  border: 1px solid #ccc;
  display: inline-block;
}

.usage-tips {
  margin-top: 40px;
  padding: 25px;
  background: #f8f9fa;
  border-radius: 10px;
  border-left: 5px solid #28a745;
}

.usage-tips h3 {
  color: #28a745;
  margin-top: 0;
}

.code-example {
  margin-top: 20px;
}

.code-example h4 {
  color: #495057;
  margin-bottom: 10px;
}

.code-example pre {
  background: #2d3748;
  color: #e2e8f0;
  padding: 15px;
  border-radius: 8px;
  overflow-x: auto;
  font-family: 'Courier New', monospace;
  font-size: 0.9em;
  line-height: 1.4;
}

.code-example code {
  color: #e2e8f0;
}
</style>
